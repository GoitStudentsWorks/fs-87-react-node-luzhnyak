{"ast":null,"code":"import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { setToken, clearToken, requestUserSignUp, requestUserLogin, requestUserLogout, refreshCurrentUser } from 'services/waterApi';\n\n//TODO: add notifications\n\nexport const signUpThunk = createAsyncThunk('auth/register', async (formData, thunkApi) => {\n  try {\n    const response = await requestUserSignUp(formData);\n    return response;\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n});\nexport const loginThunk = createAsyncThunk('auth/login', async (formData, thunkApi) => {\n  try {\n    const response = await requestUserLogin(formData);\n    return response;\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n});\nexport const logoutThunk = createAsyncThunk('auth/logout', async (_, thunkApi) => {\n  try {\n    await requestUserLogout();\n    clearToken();\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n});\nexport const refreshCurrentUserThunk = createAsyncThunk('auth/refresh', async (_, thunkApi) => {\n  const state = thunkApi.getState();\n  const token = state.auth.token;\n  try {\n    setToken(token);\n    const response = await refreshCurrentUser();\n    return response;\n  } catch (error) {\n    return thunkApi.rejectWithValue(error.message);\n  }\n}, {\n  condition: (_, thunkApi) => {\n    const state = thunkApi.getState();\n    const token = state.auth.token;\n    if (!token) {\n      return thunkApi.rejectWithValue('Unable to fetch user');\n    }\n    return true;\n  }\n});","map":{"version":3,"names":["createAsyncThunk","setToken","clearToken","requestUserSignUp","requestUserLogin","requestUserLogout","refreshCurrentUser","signUpThunk","formData","thunkApi","response","error","rejectWithValue","message","loginThunk","logoutThunk","_","refreshCurrentUserThunk","state","getState","token","auth","condition"],"sources":["D:/Web/aqua-frontend/src/redux/auth/operations.js"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\r\n\r\nimport {\r\n  setToken,\r\n  clearToken,\r\n  requestUserSignUp,\r\n  requestUserLogin,\r\n  requestUserLogout,\r\n  refreshCurrentUser,\r\n} from 'services/waterApi';\r\n\r\n//TODO: add notifications\r\n\r\nexport const signUpThunk = createAsyncThunk(\r\n  'auth/register',\r\n  async (formData, thunkApi) => {\r\n    try {\r\n      const response = await requestUserSignUp(formData);\r\n      return response;\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const loginThunk = createAsyncThunk(\r\n  'auth/login',\r\n  async (formData, thunkApi) => {\r\n    try {\r\n      const response = await requestUserLogin(formData);\r\n      return response;\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const logoutThunk = createAsyncThunk(\r\n  'auth/logout',\r\n  async (_, thunkApi) => {\r\n    try {\r\n      await requestUserLogout();\r\n      clearToken();\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const refreshCurrentUserThunk = createAsyncThunk(\r\n  'auth/refresh',\r\n  async (_, thunkApi) => {\r\n    const state = thunkApi.getState();\r\n    const token = state.auth.token;\r\n\r\n    try {\r\n      setToken(token);\r\n      const response = await refreshCurrentUser();\r\n      return response;\r\n    } catch (error) {\r\n      return thunkApi.rejectWithValue(error.message);\r\n    }\r\n  },\r\n\r\n  {\r\n    condition: (_, thunkApi) => {\r\n      const state = thunkApi.getState();\r\n      const token = state.auth.token;\r\n      if (!token) {\r\n        return thunkApi.rejectWithValue('Unable to fetch user');\r\n      }\r\n      return true;\r\n    },\r\n  }\r\n);\r\n"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,kBAAkB;AAEnD,SACEC,QAAQ,EACRC,UAAU,EACVC,iBAAiB,EACjBC,gBAAgB,EAChBC,iBAAiB,EACjBC,kBAAkB,QACb,mBAAmB;;AAE1B;;AAEA,OAAO,MAAMC,WAAW,GAAGP,gBAAgB,CACzC,eAAe,EACf,OAAOQ,QAAQ,EAAEC,QAAQ,KAAK;EAC5B,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMP,iBAAiB,CAACK,QAAQ,CAAC;IAClD,OAAOE,QAAQ;EACjB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAOF,QAAQ,CAACG,eAAe,CAACD,KAAK,CAACE,OAAO,CAAC;EAChD;AACF,CACF,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGd,gBAAgB,CACxC,YAAY,EACZ,OAAOQ,QAAQ,EAAEC,QAAQ,KAAK;EAC5B,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMN,gBAAgB,CAACI,QAAQ,CAAC;IACjD,OAAOE,QAAQ;EACjB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAOF,QAAQ,CAACG,eAAe,CAACD,KAAK,CAACE,OAAO,CAAC;EAChD;AACF,CACF,CAAC;AAED,OAAO,MAAME,WAAW,GAAGf,gBAAgB,CACzC,aAAa,EACb,OAAOgB,CAAC,EAAEP,QAAQ,KAAK;EACrB,IAAI;IACF,MAAMJ,iBAAiB,CAAC,CAAC;IACzBH,UAAU,CAAC,CAAC;EACd,CAAC,CAAC,OAAOS,KAAK,EAAE;IACd,OAAOF,QAAQ,CAACG,eAAe,CAACD,KAAK,CAACE,OAAO,CAAC;EAChD;AACF,CACF,CAAC;AAED,OAAO,MAAMI,uBAAuB,GAAGjB,gBAAgB,CACrD,cAAc,EACd,OAAOgB,CAAC,EAAEP,QAAQ,KAAK;EACrB,MAAMS,KAAK,GAAGT,QAAQ,CAACU,QAAQ,CAAC,CAAC;EACjC,MAAMC,KAAK,GAAGF,KAAK,CAACG,IAAI,CAACD,KAAK;EAE9B,IAAI;IACFnB,QAAQ,CAACmB,KAAK,CAAC;IACf,MAAMV,QAAQ,GAAG,MAAMJ,kBAAkB,CAAC,CAAC;IAC3C,OAAOI,QAAQ;EACjB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAOF,QAAQ,CAACG,eAAe,CAACD,KAAK,CAACE,OAAO,CAAC;EAChD;AACF,CAAC,EAED;EACES,SAAS,EAAEA,CAACN,CAAC,EAAEP,QAAQ,KAAK;IAC1B,MAAMS,KAAK,GAAGT,QAAQ,CAACU,QAAQ,CAAC,CAAC;IACjC,MAAMC,KAAK,GAAGF,KAAK,CAACG,IAAI,CAACD,KAAK;IAC9B,IAAI,CAACA,KAAK,EAAE;MACV,OAAOX,QAAQ,CAACG,eAAe,CAAC,sBAAsB,CAAC;IACzD;IACA,OAAO,IAAI;EACb;AACF,CACF,CAAC"},"metadata":{},"sourceType":"module"}